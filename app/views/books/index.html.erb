<p class="alert alert-success"><%= notice %></p>

<% content_for :title, "Books" %>

<h1 class="my-4">書籍検索</h1>

<%= form_with url: books_path, method: :get, local: true do |form| %>
  <div class="row mb-4">
    <div class="col-md-7">
      <%= form.text_field :q, value: params[:q], class: "form-control", placeholder: "タイトル・著者を入力" %>
    </div>

    <div class="col-md-2">
      <%= form.select :category, Book.distinct.pluck(:category), include_blank: "全て", selected: params[:category], class: "form-control", prompt: "カテゴリ選択" %>
    </div>

    <div class="col-md-1">
      <%= form.submit "検索", class: "btn btn-primary w-100" %>
    </div>
  </div>
<% end %>

<table class="table table-bordered">
  <thead class="thead-dark table-primary">
    <tr>
      <th>タイトル</th>
      <th>著者</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.title %></td>
        <td><%= book.author %></td>
        <td>
          <%= link_to "詳細", book, class: "btn btn-primary btn-sm" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% if current_user&.admin? %>
  <%= link_to "新しい本を追加", new_book_path, class: "btn btn-success my-4" %>
<% end %>